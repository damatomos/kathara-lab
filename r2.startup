ifconfig eth0 10.0.0.1/24
ifconfig eth1 192.168.0.1/24
ifconfig eth2 10.10.10.5/24

route add default gw 10.10.10.1
echo "nameserver 8.8.8.8" > /etc/resolv.conf

route add -net 10.0.0.0/24 gw 10.0.0.1
route add -net 192.168.0.0/24 gw 192.168.0.1
route add -net 10.10.10.0/24 gw 10.10.10.5

# question 01
iptables -P INPUT DROP
iptables -P FORWARD DROP

# question 03
#iptables -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT
iptables -A INPUT -s 10.10.10.1 -p tcp -m tcp --dport 22 -j ACCEPT

iptables -A FORWARD -m state --state RELATED,ESTABLISHED -j ACCEPT

iptables -A FORWARD -s 10.0.0.0/24 -d 10.10.10.1/32 -p tcp -m tcp --dport 22 -j ACCEPT

iptables -A FORWARD -s 10.10.10.1 -d 10.0.0.0/24 -p tcp --dport 22 -j ACCEPT

iptables -A FORWARD -s 192.168.0.0/24 -d 10.10.10.1 -p tcp -m tcp --dport 22 -j ACCEPT

iptables -A FORWARD -d 192.168.0.0/24 -s 10.10.10.1 -p tcp -m tcp --dport 22 -j ACCEPT

# question 4

iptables -I FORWARD 2 -p tcp -s 10.0.0.0/24 -d 192.168.0.0/255.255.255.100 -j ACCEPT

iptables -I FORWARD 3 -p tcp -s 192.168.0.0/255.255.255.100 -d 10.0.0.0/24 -j ACCEPT

iptables -I FORWARD 4 -p tcp -s 10.10.10.0/24 -d 192.168.0.0/255.255.255.100 -j ACCEPT

iptables -I FORWARD 5 -p tcp -s 192.168.0.0/255.255.255.100 -d 10.10.10.0/24 -j ACCEPT

# question 5

iptables -I FORWARD 6 -p udp --dport 53 -s 192.168.0.0/255.255.255.100 -d 10.0.0.253 -j ACCEPT

iptables -I FORWARD 7 -p udp --dport 53 -s 10.0.0.253 -d 192.168.0.0/255.255.255.100 -j ACCEPT

# question 6
iptables -I FORWARD 8 -p udp --dport 53 -s 10.10.10.0/24 -d 10.0.0.253 -j ACCEPT

iptables -I FORWARD 9 -p udp --dport 53 -s 10.0.0.253 -d 10.10.10.0/24 -j ACCEPT

# question 7
iptables -t nat -A POSTROUTING -o eth2 -j MASQUERADE
iptables -I INPUT -p icmp --icmp-type echo-request -j ACCEPT
